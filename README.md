# PM Assistant - AI驱动的产品经理助手

## 项目愿景

打造一个基于AI的产品开发助手，帮助产品经理从0到1实现产品落地，降低技术门槛，实现从需求到上线的全流程支持。

## 核心特点

* 基于自然语言对话的产品开发流程
* AI辅助文档生成系统
* 保留关键节点的人工干预
* 完整的文档体系支持
* UI微调指令生成工具

## 当前开发状态

项目已进入实现阶段，基于Next.js和React构建，主要功能包括：

* 产品需求收集和定义
* 文档生成和管理
* 技术方案规划
* 页面设计支持
* UI微调指令生成

## 核心功能

### 1. UI 微调表单 (`/`)
- **功能**：完整的 UI 微调指令生成流程
- **特点**：
  - 多步骤表单引导
  - 页面选择（基于 bbx-project-analysis.json）
  - 元素选择和描述
  - 微调类型和优先级设置
  - 结构化输出生成

### 2. BBX 预览测试 (`/bbx-preview-test`)
- **功能**：实时预览 BBX 页面并测试 postMessage 通信
- **特点**：
  - 左侧页面选择器
  - 右侧 iframe 预览（支持本地 BBX 项目）
  - 底部消息监听显示
  - 支持真实页面交互测试

### 3. 截图标注工具 (`/screenshot-annotator`) ⭐ 新增
- **功能**：为页面截图定义高亮区域，生成配置文件
- **使用方法**：
  1. 选择要标注的截图
  2. 在截图上拖拽鼠标选择区域
  3. 设置区域名称、类型、描述和优先级
  4. 点击已有区域进行编辑
  5. 导出 JSON 配置文件

#### 配置管理功能：
- **自动保存**：标注的区域会自动保存到浏览器本地存储
- **配置状态显示**：页面选择器显示每个页面的配置状态（✅已配置 / ⚪未配置）
- **配置统计**：顶部显示已配置页面数量统计
- **导入导出**：
  - 导出当前页面配置
  - 导出所有页面配置
  - 导入单个或批量配置文件
- **配置清理**：支持清空当前页面或所有页面的配置

#### 区域类型说明：
- **navigation**：导航相关元素（菜单、导航栏等）
- **content**：内容区域（文章、列表、卡片等）
- **action**：操作元素（按钮、链接等）
- **form**：表单元素（输入框、选择器等）

#### 配置文件格式：
```json
{
  "pageName": "页面名称",
  "screenshot": "截图文件名.png",
  "regions": [
    {
      "id": "唯一标识",
      "name": "区域名称",
      "type": "区域类型",
      "coordinates": {
        "x": 100,
        "y": 200,
        "width": 300,
        "height": 150
      },
      "description": "区域功能描述",
      "priority": 5
    }
  ]
}
```

## 技术架构

### 核心技术栈

* **前端框架**: Next.js 15.2.4 + React 19.0.0
* **UI组件库**: Radix UI + Tailwind CSS
* **状态管理**: Zustand
* **AI集成**: OpenAI API
* **部署平台**: Vercel

### 核心技术
- **iframe + postMessage**：跨域页面通信
- **Canvas 坐标计算**：精确的区域定位
- **JSON 配置管理**：结构化数据存储

### 应用结构

* **文档列表页**: 展示和管理所有创建的产品文档
* **文档编辑页**: 创建和编辑产品文档，支持AI辅助
* **仪表盘页**: 提供项目概览和快速访问入口

### 项目结构
```
pm-assistant/
├── src/
│   ├── app/
│   │   ├── page.tsx                    # 主表单页面
│   │   ├── bbx-preview-test/           # BBX 预览测试
│   │   └── screenshot-annotator/       # 截图标注工具
│   ├── components/
│   │   ├── ui/                         # UI 组件库
│   │   └── SimpleUIMicroAdjustmentForm.tsx
│   └── data/
│       └── bbx-project-analysis.json   # 页面配置数据
├── public/
│   └── screenshots/                    # 页面截图存储
└── README.md
```

## 核心规划流程 (V2 - 引入 PRD 检查)

本助手提供三种核心规划流程，以适应不同的开发场景。用户在启动规划时会被引导选择其中一种模式：

### 流程 A：开发一个全新的产品

* **适用场景:** 从零开始构思和开发新产品。
* **组件流程:** `ProductDefinitionForm` -> `TechnicalPlanningForm` -> `PagePlanningForm`
* **关键步骤:**  
   1. **产品定义:** 全面收集产品基础信息（平台、概念、用户、核心功能、参考）及细化追问（价值、场景、优先级）。  
   2. **技术规划:** 选择整体技术架构、数据库、API 风格、UI 库等。  
   3. **页面规划:** 逐个规划新产品所需的核心页面。  
   4. **完成:** 输出完整的初步规划信息。
* **PRD 期望:** 此流程本身旨在帮助用户生成初步的 PRD 核心内容。如果用户已有草稿，可在对话中参考。

### 流程 B：优化已有功能/页面

* **适用场景:** 针对现有产品或项目中的某个具体功能或页面进行改进。
* **组件流程:** `OptimizationForm`
* **关键步骤:**  
   1. **定位:** 确定优化的平台和具体功能/页面名称。  
   2. **PRD 检查:** 询问是否有相关 PRD 文档描述**当前**的功能状态。  
   3. **信息收集 (二选一):**  
         * **有 PRD:** 用户提供 -> (AI 模拟) 读取并生成摘要 -> 用户确认/补充摘要。  
         * **无 PRD:** 用户描述当前问题/不足。  
   4. **目标设定:** 用户描述优化的具体目标。  
   5. **方案构思:** 用户描述初步的优化方案或思路。  
   6. **技术讨论点引导:** 用户思考并记录可能需要与技术团队沟通的方面（非强制技术判断）。  
   7. **完成:** 输出优化规划信息。
* **PRD 期望:** 理想情况是存在描述该功能原始状态的 PRD。本次优化的 PRD (或修订) 应重点说明**问题、目标和改动方案**。

### 流程 C：为现有产品添加新功能/页面

* **适用场景:** 在现有产品或项目的基础上增加新的功能模块或页面。
* **组件流程:** `AddFeatureForm` -> (可选) `TechnicalPlanningForm` -> (可选) `PagePlanningForm`
* **关键步骤:**  
   1. **定位:** 确定添加功能的平台和新功能的名称与主要作用。  
   2. **PRD 检查:** 询问是否有描述**新功能**需求的 PRD 文档。  
   3. **信息收集 (二选一):**  
         * **有 PRD:** 用户提供 -> (AI 模拟) 读取并生成关于新功能(目标/用户/流程)的摘要 -> 用户确认/补充摘要。  
         * **无 PRD:** 用户依次描述新功能的目标与价值、目标用户、核心流程。  
   4. **集成点:** 用户描述新功能如何与现有功能/数据交互。  
   5. **后续规划决策:** 用户选择是否继续进行技术和页面规划。  
   6. **(可选) 技术规划:** (若继续) 使用 `TechnicalPlanningForm` 规划新功能所需的技术支持 (基于现有技术栈)。  
   7. **(可选) 页面规划:** (若继续) 使用 `PagePlanningForm` 规划新功能相关的页面。  
   8. **完成:** 输出新功能规划信息。
* **PRD 期望:** 新功能的 PRD 应包含目标、用户、功能/故事、流程，并**重点描述如何与现有系统集成**。

## 使用指南

### 开发环境启动
```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 访问应用
http://localhost:3000
```

### BBX 项目集成
1. 确保 BBX 项目在 `http://localhost:3001` 运行
2. 访问 `/bbx-preview-test` 页面
3. 选择对应页面进行预览和测试

### 截图标注流程
1. 将页面截图放入 `public/screenshots/` 目录
2. 访问 `/screenshot-annotator` 页面
3. 选择截图并开始标注
4. 导出配置文件用于后续开发

## 数据格式

### 页面配置 (bbx-project-analysis.json)
```json
{
  "pages": [
    {
      "label": "分组名称",
      "options": [
        {
          "value": "page_key",
          "label": "页面名称",
          "disabled": false
        }
      ]
    }
  ]
}
```

### 高亮区域配置
- **坐标系统**：基于截图像素坐标
- **区域类型**：navigation | content | action | form
- **优先级**：1-10（数字越大优先级越高）

## 产品架构

### 1. 基于对话的产品开发流程

#### 优点

* 自然语言交互降低使用门槛
* 通过对话更好地捕捉产品经理的真实意图
* AI可以通过提问引导产品经理完善思路

#### 需要注意

* 如何确保对话的结构化和完整性
* 如何避免理解偏差
* 如何处理模糊不清的需求

### 2. 文档生成体系

#### 第一层：产品定义文档

* 产品愿景
* 目标用户画像
* 核心价值主张
* 关键功能列表

#### 第二层：PRD文档

* 详细功能描述
* 用户故事
* 业务流程
* 数据流转

#### 第三层：技术规划文档

* 技术架构设计
* 数据库设计
* API接口设计
* 前端组件设计

#### 第四层：实施文档

* 开发计划
* 测试用例
* 部署方案
* 监控方案

### 3. AI辅助功能

#### 需求完整性检查

* 自动检测需求中的逻辑漏洞
* 提供相似产品的参考建议
* 生成需求完整性检查清单

#### 交互设计辅助

* 基于需求自动推荐UI组件
* 生成页面布局建议
* 提供用户体验优化建议

#### 技术方案生成

* 根据需求推荐适合的技术栈
* 生成数据库结构
* 设计API接口规范

#### 代码实现辅助

* 生成基础代码框架
* 提供代码实现建议
* 自动生成单元测试

### 4. 人工干预节点

* 需求确认阶段
* 技术方案评审
* 关键业务逻辑确认
* 安全相关决策
* 性能优化决策

### 5. 工作流程

```
对话收集需求 -> 生成初步文档 -> 人工确认和修改 -> AI完善和展开 -> 技术方案生成 -> 人工评审 -> 代码实现
```

## 开发计划

### 已完成 ✅
- [x] 基础表单流程
- [x] BBX 页面预览集成
- [x] 截图标注工具
- [x] postMessage 通信机制
- [x] 配置文件导出功能
- [x] 核心规划流程设计

### 进行中 🚧
- [ ] stagewise 元素选择器集成
- [ ] 真实页面高亮与采集
- [ ] 配置文件管理系统

### 计划中 📋
- [ ] AI 辅助区域识别
- [ ] 批量标注功能
- [ ] 配置文件版本管理
- [ ] 与开发工具集成

## 注意事项

1. **截图文件**：建议使用 PNG 格式，文件名避免特殊字符
2. **坐标精度**：标注时尽量精确选择区域边界
3. **区域命名**：使用有意义的名称，便于后续识别
4. **配置备份**：定期备份导出的配置文件

## 技术支持

如有问题或建议，请通过以下方式联系：
- 项目 Issues
- 开发团队内部沟通渠道
